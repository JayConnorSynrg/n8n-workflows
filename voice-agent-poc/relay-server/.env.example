# ============================================================
# ENTERPRISE VOICE AGENT - ENVIRONMENT CONFIGURATION
# ============================================================

# ============================================================
# MANDATORY CONFIGURATION (Server will not start without these)
# ============================================================

# OpenAI API Key (required)
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-...

# PostgreSQL Database URL (REQUIRED - mandatory logging)
# Server WILL NOT START without a valid database connection
# Format: postgres://user:password@host:port/database
DATABASE_URL=postgres://user:password@localhost:5432/voice_agent

# Server Configuration (optional)
PORT=3000
HEALTH_PORT=3001
LOG_LEVEL=INFO

# ============================================================
# n8n INTEGRATION (required for tool execution)
# ============================================================

# n8n webhook URL for tool execution (from Enterprise Voice Agent Tools workflow)
# Format: https://your-n8n-instance.com/webhook/voice-tools
N8N_TOOLS_WEBHOOK=https://jayconnorexe.app.n8n.cloud/webhook/voice-tools

# n8n webhook URL for logging (optional)
# Format: https://your-n8n-instance.com/webhook/voice-logs
N8N_LOGGING_WEBHOOK=https://jayconnorexe.app.n8n.cloud/webhook/voice-logs

# Webhook secret for authentication (optional but recommended)
# Generate with: openssl rand -hex 16
WEBHOOK_SECRET=your-32-char-secret-here

# ============================================================
# RECALL.AI INTEGRATION (for meeting audio injection)
# ============================================================

# Recall.ai API key for meeting bot audio injection
# Get from: https://recall.ai/dashboard
RECALL_API_KEY=your-recall-api-key

# Default Recall.ai bot ID (can be overridden per session)
# This is the bot ID that joins Teams/Zoom meetings
RECALL_BOT_ID=your-recall-bot-id

# ============================================================
# ERROR HANDLING & RESILIENCE
# ============================================================

# Maximum connection retry attempts before circuit breaker opens
MAX_RETRIES=5

# Base delay for exponential backoff (milliseconds)
RETRY_BASE_DELAY_MS=1000

# Circuit breaker cooldown period (milliseconds)
CIRCUIT_BREAKER_COOLDOWN_MS=30000

# ============================================================
# AUDIO QUALITY MONITORING
# ============================================================

# Maximum packet loss rate before logging warnings (0.0 - 1.0)
# 0.05 = 5% packet loss threshold
AUDIO_LOSS_THRESHOLD=0.05

# ============================================================
# SUPABASE INTEGRATION (for bot_state lookup)
# ============================================================

# Supabase project URL
# Get from: https://app.supabase.com/project/_/settings/api
SUPABASE_URL=https://your-project.supabase.co

# Supabase anonymous key (public, safe to use client-side)
SUPABASE_ANON_KEY=your-anon-key

# ============================================================
# GATED WORKFLOW CALLBACKS (for n8n progress notifications)
# ============================================================

# Callback endpoint for n8n gated execution progress
# This endpoint receives status updates from gated workflows
# Format: https://your-relay-server/tool-progress
CALLBACK_BASE_URL=https://your-relay.railway.app

# ============================================================
# DATABASE SCHEMA NOTES
# ============================================================
# Run the schema from: voice-agent-poc/database/schema.sql
# Required tables: tool_executions, audit_trail, training_metrics, user_session_analytics
# Required views: v_tool_success_rates, v_user_engagement, v_training_progress
#
# NEW TABLES (for gated execution):
# - tool_calls: Gated execution tracking with status history
# - session_context: Cross-tool data sharing with 1-hour TTL
